
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Splash Flows Globus Documentation">
      
      
        <meta name="author" content="ALS Computing">
      
      
        <link rel="canonical" href="https://als-computing.github.io/splash_flows_globus/getting_started/">
      
      
        <link rel="prev" href="../install/">
      
      
        <link rel="next" href="../alcf832/">
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.12">
    
    
      
        <title>Getting Started - Splash Flows Globus Documentation</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.2afb09e1.min.css">
      
      


    
    
  
      
    

    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../assets/als_style.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#getting-started" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="Splash Flows Globus Documentation" class="md-header__button md-logo" aria-label="Splash Flows Globus Documentation" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Splash Flows Globus Documentation
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Getting Started
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/als-computing/splash_flows_globus" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    splash_flows_globus
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="Splash Flows Globus Documentation" class="md-nav__button md-logo" aria-label="Splash Flows Globus Documentation" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    Splash Flows Globus Documentation
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/als-computing/splash_flows_globus" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    splash_flows_globus
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../install/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Installation and Requirements
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    Getting Started
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    Getting Started
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#hpc-access" class="md-nav__link">
    <span class="md-ellipsis">
      HPC Access
    </span>
  </a>
  
    <nav class="md-nav" aria-label="HPC Access">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#alcf" class="md-nav__link">
    <span class="md-ellipsis">
      ALCF
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#nersc" class="md-nav__link">
    <span class="md-ellipsis">
      NERSC
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#olcf" class="md-nav__link">
    <span class="md-ellipsis">
      OLCF
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#globus" class="md-nav__link">
    <span class="md-ellipsis">
      Globus
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Globus">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#confidential-client" class="md-nav__link">
    <span class="md-ellipsis">
      Confidential Client
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#globus-transfer" class="md-nav__link">
    <span class="md-ellipsis">
      Globus Transfer
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#globus-compute" class="md-nav__link">
    <span class="md-ellipsis">
      Globus Compute
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#prefect" class="md-nav__link">
    <span class="md-ellipsis">
      Prefect
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Prefect">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#login-to-prefect-in-your-environment" class="md-nav__link">
    <span class="md-ellipsis">
      Login to Prefect in your environment
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#register-a-flow" class="md-nav__link">
    <span class="md-ellipsis">
      Register a Flow
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#start-a-agentsworkers" class="md-nav__link">
    <span class="md-ellipsis">
      Start a Agents/Workers
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#call-a-flow" class="md-nav__link">
    <span class="md-ellipsis">
      Call a Flow
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../alcf832/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Compute at ALCF
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../nersc832/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Compute at NERSC
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../orchestration/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Orchestration
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../configuration/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Configuration
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../glossary/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Glossary
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../about/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    About
    
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#hpc-access" class="md-nav__link">
    <span class="md-ellipsis">
      HPC Access
    </span>
  </a>
  
    <nav class="md-nav" aria-label="HPC Access">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#alcf" class="md-nav__link">
    <span class="md-ellipsis">
      ALCF
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#nersc" class="md-nav__link">
    <span class="md-ellipsis">
      NERSC
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#olcf" class="md-nav__link">
    <span class="md-ellipsis">
      OLCF
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#globus" class="md-nav__link">
    <span class="md-ellipsis">
      Globus
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Globus">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#confidential-client" class="md-nav__link">
    <span class="md-ellipsis">
      Confidential Client
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#globus-transfer" class="md-nav__link">
    <span class="md-ellipsis">
      Globus Transfer
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#globus-compute" class="md-nav__link">
    <span class="md-ellipsis">
      Globus Compute
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#prefect" class="md-nav__link">
    <span class="md-ellipsis">
      Prefect
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Prefect">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#login-to-prefect-in-your-environment" class="md-nav__link">
    <span class="md-ellipsis">
      Login to Prefect in your environment
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#register-a-flow" class="md-nav__link">
    <span class="md-ellipsis">
      Register a Flow
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#start-a-agentsworkers" class="md-nav__link">
    <span class="md-ellipsis">
      Start a Agents/Workers
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#call-a-flow" class="md-nav__link">
    <span class="md-ellipsis">
      Call a Flow
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
  


<h1 id="getting-started">Getting Started</h1>
<p>To use the full functionality of this project, there are a few additional steps required to get started. Some of our workflows are run at specific HPC facilities, which requires getting user accounts and project access. We also rely on Prefect, a data orchestration tool, to launch and monitor our jobs.</p>
<h2 id="hpc-access">HPC Access</h2>
<p>We support running flows on a couple of DOE supercomputer facilities, ALCF and NERSC, and in the near future we will support OLCF as well. Since each facility has different hardware and software configurations, the steps for gaining access to and running code on these systems will vary.</p>
<hr />
<h3 id="alcf">ALCF</h3>
<p>We support running computation tasks at Argonne Leadership Compute Facility (ALCF) through Globus Compute. <a href="https://www.alcf.anl.gov/events/remote-workflows-alcf">This webinar</a> provides a great overview to running remote workflows at ALCF and the tools that are available. To gain access to this system, you can <a href="https://my.alcf.anl.gov/accounts/#/accountRequest">request an account</a>.</p>
<p>Once you have an account, you can login to Polaris:</p>
<p><strong>SSH into Polaris</strong></p>
<p>Login to Polaris using the following terminal command:</p>
<pre><code class="language-bash">ssh &lt;your ALCF username&gt;@polaris.alcf.anl.gov
</code></pre>
<p>Password: copy passcode from the MobilePASS+ app.</p>
<hr />
<h3 id="nersc">NERSC</h3>
<p>We schedule computing tasks at National Energy Research Scientific Computing Center (NERSC) by leveraging Docker, SLURM, and SFAPI. To get access to these systems <a href="https://docs.nersc.gov/accounts/">follow these instructions</a>.</p>
<p>Once you have an account, you can follow along <a href="../nersc832/">here to see how to schedule remote tomography reconstructions at NERSC</a>.</p>
<hr />
<h3 id="olcf">OLCF</h3>
<ul>
<li>
<p><a href="https://my.olcf.ornl.gov/login">Request access and login to OLCF.</a></p>
</li>
<li>
<p><a href="https://docs.olcf.ornl.gov/index.html">OLCF user documentation.</a></p>
</li>
</ul>
<hr />
<h2 id="globus">Globus</h2>
<p>We use <a href="https://www.globus.org/">Globus</a> for two main purposes:</p>
<ol>
<li>High-speed file transfer</li>
<li>Scheduling and running compute jobs</li>
</ol>
<p><a href="https://www.globus.org/get-started">Follow these instructions</a> to get started with Globus.</p>
<h3 id="confidential-client">Confidential Client</h3>
<p>Once you have a Globus account, you can create a <code>Confidential Client</code>. This generates a unique ID and key for authenticating with Globus through the API, avoiding a manual authentication step redirecting to the web login page. </p>
<p><strong>Use an existing Globus Confidential Client, or create a new one</strong></p>
<ul>
<li>In your browser, navigate to globus.org</li>
<li>Login</li>
<li>On the left, navigate to "Settings"</li>
<li>On the top navigation bar, select "Developers" </li>
<li>On the right under Projects, create a new project called Splash Flows or select an existing one</li>
<li>Create a new registered app called Splash Flows App, or select an existing one</li>
<li>Generate a secret</li>
<li>Store the confidential client UUID and Secret (note: make sure you copy the Client UUID and <strong>not</strong> the Secret UUID)</li>
</ul>
<p><strong>Note:</strong> For each service client, you will need to get permissions set by the correct person at ALCF, NERSC or other facility to be able to use it for transfer endpoints depending on how guest collections are configured.</p>
<h3 id="globus-transfer">Globus Transfer</h3>
<p>Globus allows us to move data between computers at the ALS, and also to transfer endpoints at HPC facilities. Transferring data via Globus can be done in their web user interface, as well as in Python via their API.</p>
<h3 id="globus-compute">Globus Compute</h3>
<p>For some data workflows we use Globus Compute to easily execute our code at an HPC facility such as ALCF. This requires configuring a <a href="https://globus-compute.readthedocs.io/en/stable/endpoints/endpoints.html">globus-compute-endpoint</a> on the HPC system that listens for incoming compute tasks and schedules those jobs as soon as resources are available. Â </p>
<p>Learn how to get Globus Compute set up at <a href="../alcf832/">ALCF to run tomography reconstructions</a>.</p>
<hr />
<h2 id="prefect">Prefect</h2>
<p><a href="https://docs.prefect.io/latest/">Prefect</a> is a workflow orchestration tool that allows us to register Python functions as "Tasks" and "Flows" that can be called, scheduled, and monitored nicely within their web user interface.</p>
<p>There are several approaches to using Prefect. </p>
<ol>
<li>Prefect Cloud<ul>
<li>Good for local development and debugging.</li>
<li>Less ideal for a production environment.</li>
</ul>
</li>
<li>Your own Prefect server deployment<ul>
<li>Scalable, but you are responsible for making sure the server is running.</li>
<li>Ideal for production environments where you are launching Docker containers.</li>
</ul>
</li>
</ol>
<p>Here is an example of the <a href="https://github.com/als-computing/service_configs">service_configs for our Prefect server</a>.</p>
<h3 id="login-to-prefect-in-your-environment">Login to Prefect in your environment</h3>
<p>Before running or registering any flows, you must ensure you are authenticated with your Prefect server. Depending on your setup, do one of the following:</p>
<ul>
<li>
<p><strong>For Prefect Cloud:</strong><br />
  Run the following command and follow the instructions to authenticate:</p>
<p><code>bash
prefect cloud login</code></p>
<p>or you can run the following to set your env variables directly:</p>
<p><code>prefect config set PREFECT_API_URL="[API-URL]"</code></p>
<p><code>prefect config set PREFECT_API_KEY="[API-KEY]"</code></p>
</li>
<li>
<p><strong>For self-hosted Prefect server:</strong></p>
<p>Please refer to <a href="https://docs.prefect.io/v3/manage/self-host">the official documentation</a>.</p>
</li>
</ul>
<h3 id="register-a-flow">Register a Flow</h3>
<p>You can run the following scripts to register the Prefect Flows in this project to the Prefect server configured in your environment.</p>
<ul>
<li>
<p><code>./create_deployment_832_dispatcher.sh</code></p>
</li>
<li>
<p><code>./create_deployments_7012.sh</code></p>
</li>
<li>
<p><code>./create_deployments_832.sh</code></p>
</li>
<li>
<p><code>./create_deployments_832_alcf.sh</code></p>
</li>
<li>
<p><code>./create_deployments_832_nersc.sh</code></p>
</li>
</ul>
<h3 id="start-a-agentsworkers">Start a Agents/Workers</h3>
<p>Prefect Agents are defined in the <code>create_deployments.sh</code> scripts, and can be started like this:</p>
<pre><code>prefect agent start --pool "alcf_flow_pool"
</code></pre>
<p>This creates an agent that listens to jobs on the <code>alcf_flow_pool</code> "Work Pool". In this way, each one of our deployed Prefect Flows can be associated with a specific Work Pool, allowing fine-grained control over the system.</p>
<h3 id="call-a-flow">Call a Flow</h3>
<p>Once a flow is registered as a deployment and your agent is running, you can trigger a run in several ways:</p>
<ul>
<li>
<p><strong>Via the Prefect UI</strong></p>
<p>Navigate to your Prefect server dashboard, locate the registered flow deployment, and trigger a run manually.</p>
</li>
<li>
<p><strong>Via the Command Line Interface</strong></p>
<p>You can also trigger a run using the Prefect CLI:</p>
<pre><code>prefect deployment run &lt;FLOW_NAME&gt;/&lt;DEPLOYMENT_NAME&gt;
</code></pre>
<p>Replace <code>&lt;FLOW_NAME&gt;/&lt;DEPLOYMENT_NAME&gt;</code> with the name of the deployment you want to run (e.g., <code>alcf_recon_flow/alcf_recon_flow</code>).</p>
</li>
<li>
<p><strong>Via API Calls</strong></p>
<p>For automation purposes, you may also call the Prefect API from your own scripts or applications using the Python SDK</p>
<pre><code>run_deployment(
    name="my-first-flow/my-first-deployment",
    parameters={"my_param": "42"},
    job_variables={"env": {"MY_ENV_VAR": "staging"}},
    timeout=0, # don't wait for the run to finish
)
</code></pre>
</li>
</ul>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
<footer class="md-footer">
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">

      <div>
        <a href="https://www.lbl.gov/" title="LBL" target="_blank">
          <img alt="LBL Home" src="../assets/images/lbl_logo.png"
               height="70" width="90"
               style="padding: 10px; height: 70px; width: 90px;">
        </a>
        <a href="https://science.energy.gov" title="DOE Office of Science" target="_blank">
          <img alt="DOE Office of Science Home" src="../assets/images/doe_logo.png"
               height="70" width="71"
               style="padding: 10px; height: 70px; width: 71px;">
        </a>
      </div>

      <a href="https://www.lbl.gov/disclaimers/" target="_blank"
         title="Privacy and Security Notice">
         Privacy and Security Notice
      </a>
      <br>

      <div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://github.com/als-computing" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
    </a>
  
</div>

    </div>
  </div>
<footer>

    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
  
      
      <script id="__config" type="application/json">{"base": "..", "features": [], "search": "../assets/javascripts/workers/search.f8cc74c7.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    

    
      <script src="../assets/javascripts/bundle.c8b220af.min.js"></script>
      
    
  </body>
</html>